(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{JrXR:function(e,t,s){"use strict";s.r(t),s.d(t,"ManageUsersModule",(function(){return I}));var i=s("ofXK"),c=s("PCNd"),n=s("tyNb"),r=s("y1cd"),o=s("3Pt+"),a=s("fXoL"),b=s("1kSV"),l=s("kmKP"),d=s("SaRM"),u=s("mAmA");function h(e,t){if(1&e){const e=a.Xb();a.Wb(0,"label",18),a.Wb(1,"input",19),a.ic("change",(function(s){a.Dc(e);const i=t.$implicit;return a.mc().onChange(s,i)})),a.Vb(),a.Wb(2,"span",20),a.Mc(3),a.Vb(),a.Vb()}if(2&e){const e=t.$implicit;a.Cb(1),a.tc("id",e.title),a.Cb(2),a.Nc(e.title)}}function g(e,t){1&e&&a.Rb(0,"span",21)}function f(e,t){if(1&e&&(a.Wb(0,"span"),a.Mc(1),a.Vb()),2&e){const e=a.mc();a.Cb(1),a.Nc(e.updateButtonText)}}let p=(()=>{class e{constructor(e,t,s,i,c){this.formBuilder=e,this.ngbActiveModal=t,this.userService=s,this.referenceService=i,this.toasterService=c,this.updateButtonText=r.b.UPDATE_BUTTON_TEXT,this.cancelButtonText=r.b.CANCEL_BUTTON_TEXT,this.loading=!1,this.accessControls=[],this.selectedMenuList=[],this.form=this.formBuilder.group({userId:["",[o.t.required]],accessMenus:[""]})}ngOnInit(){this.accessControls=this.referenceService.getAvailableAccessControls(),this.fetchUserActivityByUserId()}fetchUserActivityByUserId(){this.loading=!0,this.userService.fetchUserActivityByUserId(this.userId).subscribe(e=>{const{ProcessVariables:{status:t,message:s={}}}=e;t?(this.setForm(e),this.loading=!1):(this.loading=!1,this.toasterService.showError(s.value))},e=>{this.loading=!1,this.toasterService.showError(e)})}setForm(e){const{ProcessVariables:{activityList:t,roleName:s,userName:i}}=e;this.userDetail={activityList:t,roleName:s,userName:i},this.form.patchValue({userId:i}),this.validateAndSetAttributes()}validateAndSetAttributes(){const{activityList:e}=this.userDetail,t=e.find(e=>1===e),s=e.find(e=>2===e),i=e.find(e=>3===e),c=e.find(e=>4===e),n=document.getElementById("checkboxes").getElementsByTagName("input");t&&(n[0].checked=!0,this.selectedMenuList.push(1)),s&&(n[1].checked=!0,this.selectedMenuList.push(2)),i&&(n[2].checked=!0,this.selectedMenuList.push(3)),c&&(n[3].checked=!0,this.selectedMenuList.push(4)),this.validate()}get fieldControls(){return this.form.controls}onChange(e,t){if(e.target.checked)this.selectedMenuList.push(t.value);else{const e=this.selectedMenuList.findIndex(e=>e===t.value);this.selectedMenuList.splice(e,1)}this.validate()}validate(){const e=this.selectedMenuList.find(e=>3===e),t=this.selectedMenuList.find(e=>4===e),s=document.getElementById(r.d.MARKETING_MAKER),i=document.getElementById(r.d.MARKETING_CHECKER);e&&!t?i.setAttribute("disabled","true"):t&&!e?s.setAttribute("disabled","true"):(s.removeAttribute("disabled"),i.removeAttribute("disabled"))}updateUser(){this.loading=!0,this.userService.updateUser(this.userId,this.selectedMenuList,Number(this.userService.currentUserValue.userId)).subscribe(e=>{const{ProcessVariables:{status:t},ProcessVariables:{message:s={}}}=e;t?(this.toasterService.showSuccess(r.k.UPDATE_USER_SUCCESS),this.loading=!1,this.close(r.g.SUCCESS)):(this.loading=!1,this.toasterService.showError(s.value))},e=>{this.loading=!1,this.toasterService.showError(e)})}close(e){this.ngbActiveModal.close(e)}}return e.\u0275fac=function(t){return new(t||e)(a.Qb(o.c),a.Qb(b.a),a.Qb(l.a),a.Qb(d.a),a.Qb(u.a))},e.\u0275cmp=a.Kb({type:e,selectors:[["app-user-dialog"]],inputs:{userId:"userId"},decls:25,vars:7,consts:[[1,"modal-header"],[1,"modal-title"],[1,"text-message"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"form",3,"formGroup"],[1,"form-group"],["for","userId"],[1,"input-group"],["type","text","formControlName","userId","id","userId","placeholder","Eg: USER0001","autocomplete","off","readonly","",1,"form-control"],["id","checkboxes",1,"row","d-flex"],["class","col-6 checkbox-inline container-checkbox",4,"ngFor","ngForOf"],[1,"modal-footer"],["ngbAutofocus","",1,"btn","btn-confirm","shadow",3,"disabled","click"],["class","spinner-border","style","width: 1rem; height: 1rem;","aria-hidden","true",4,"ngIf"],[4,"ngIf"],["type","button",1,"btn","btn-danger","shadow",3,"click"],[1,"col-6","checkbox-inline","container-checkbox"],["type","checkbox","formControlName","accessMenus",1,"mx-1","checkbox-input",3,"id","change"],[1,"checkbox-title"],["aria-hidden","true",1,"spinner-border",2,"width","1rem","height","1rem"]],template:function(e,t){1&e&&(a.Wb(0,"div",0),a.Wb(1,"h4",1),a.Mc(2," Edit User - "),a.Wb(3,"span",2),a.Mc(4),a.Vb(),a.Vb(),a.Wb(5,"button",3),a.ic("click",(function(){return t.close()})),a.Wb(6,"span",4),a.Mc(7,"\xd7"),a.Vb(),a.Vb(),a.Vb(),a.Wb(8,"div",5),a.Wb(9,"form",6),a.Wb(10,"div",7),a.Wb(11,"label",8),a.Mc(12,"USER ID"),a.Vb(),a.Wb(13,"div",9),a.Rb(14,"input",10),a.Vb(),a.Vb(),a.Wb(15,"label"),a.Mc(16,"ACCESS CONTROLS"),a.Vb(),a.Wb(17,"div",11),a.Kc(18,h,4,2,"label",12),a.Vb(),a.Vb(),a.Vb(),a.Wb(19,"div",13),a.Wb(20,"button",14),a.ic("click",(function(){return t.updateUser()})),a.Kc(21,g,1,0,"span",15),a.Kc(22,f,2,1,"span",16),a.Vb(),a.Wb(23,"button",17),a.ic("click",(function(){return t.close()})),a.Mc(24),a.Vb(),a.Vb()),2&e&&(a.Cb(4),a.Nc(t.userDetail&&t.userDetail.userName),a.Cb(5),a.sc("formGroup",t.form),a.Cb(9),a.sc("ngForOf",t.accessControls),a.Cb(2),a.sc("disabled",t.form.invalid||0===t.selectedMenuList.length||t.loading),a.Cb(1),a.sc("ngIf",t.loading),a.Cb(1),a.sc("ngIf",!t.loading),a.Cb(2),a.Oc(" ",t.cancelButtonText," "))},directives:[o.v,o.n,o.h,o.b,o.m,o.f,i.l,i.m,o.a],styles:[".checkbox-title[_ngcontent-%COMP%]{font-size:16px;color:#212529}"]}),e})();function m(e,t){1&e&&a.Rb(0,"span",11)}function v(e,t){if(1&e&&(a.Wb(0,"span"),a.Mc(1),a.Vb()),2&e){const e=a.mc();a.Cb(1),a.Nc(e.disableButtonText)}}let S=(()=>{class e{constructor(e,t,s){this.ngbActiveModal=e,this.userService=t,this.toasterService=s,this.disableButtonText=r.b.DISABLE_BUTTON_TEXT,this.cancelButtonText=r.b.CANCEL_BUTTON_TEXT,this.loading=!1}ngOnInit(){}disableUser(){this.loading=!0,this.userService.disableUserById(this.userId,Number(this.userService.currentUserValue.userId)).subscribe(e=>{const{ProcessVariables:{status:t},ProcessVariables:{message:s={}}}=e;t?(this.toasterService.showSuccess(r.k.DISABLE_USER_SUCCESS),this.loading=!1,this.close(r.g.SUCCESS)):(this.loading=!1,this.toasterService.showError(s.value))},e=>{this.loading=!1,this.toasterService.showError(e)})}close(e){this.ngbActiveModal.close(e)}}return e.\u0275fac=function(t){return new(t||e)(a.Qb(b.a),a.Qb(l.a),a.Qb(u.a))},e.\u0275cmp=a.Kb({type:e,selectors:[["app-disable-user-dialog"]],inputs:{userId:"userId",userName:"userName"},decls:15,vars:5,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"text-message"],[1,"modal-footer"],["ngbAutofocus","",1,"btn","btn-confirm","shadow",3,"disabled","click"],["class","spinner-border","style","width: 1rem; height: 1rem;","aria-hidden","true",4,"ngIf"],[4,"ngIf"],["type","button",1,"btn","btn-danger","shadow",3,"click"],["aria-hidden","true",1,"spinner-border",2,"width","1rem","height","1rem"]],template:function(e,t){1&e&&(a.Wb(0,"div",0),a.Wb(1,"h4",1),a.Mc(2," Do you want to disable user? "),a.Vb(),a.Wb(3,"button",2),a.ic("click",(function(){return t.close()})),a.Wb(4,"span",3),a.Mc(5,"\xd7"),a.Vb(),a.Vb(),a.Vb(),a.Wb(6,"div",4),a.Wb(7,"span",5),a.Mc(8),a.Vb(),a.Vb(),a.Wb(9,"div",6),a.Wb(10,"button",7),a.ic("click",(function(){return t.disableUser()})),a.Kc(11,m,1,0,"span",8),a.Kc(12,v,2,1,"span",9),a.Vb(),a.Wb(13,"button",10),a.ic("click",(function(){return t.close()})),a.Mc(14),a.Vb(),a.Vb()),2&e&&(a.Cb(8),a.Oc("Any information associated with account ",t.userName," will be deleted."),a.Cb(2),a.sc("disabled",t.loading),a.Cb(1),a.sc("ngIf",t.loading),a.Cb(1),a.sc("ngIf",!t.loading),a.Cb(2),a.Oc(" ",t.cancelButtonText," "))},directives:[i.m],styles:[""]}),e})();function C(e,t){1&e&&a.Rb(0,"ngb-progressbar",14),2&e&&a.sc("value",100)("striped",!0)("animated",!0)}function V(e,t){if(1&e){const e=a.Xb();a.Wb(0,"tr",7),a.Wb(1,"td",8),a.Mc(2),a.Vb(),a.Wb(3,"td",9),a.Mc(4),a.Vb(),a.Wb(5,"td",9),a.Mc(6),a.Vb(),a.Wb(7,"td",9),a.Mc(8),a.nc(9,"date"),a.Vb(),a.Wb(10,"td",10),a.Wb(11,"button",15),a.ic("click",(function(){a.Dc(e);const s=t.$implicit;return a.mc().editUser(s)})),a.Mc(12),a.Vb(),a.Wb(13,"button",16),a.ic("click",(function(){a.Dc(e);const s=t.$implicit;return a.mc().disableUser(s)})),a.Mc(14),a.Vb(),a.Vb(),a.Vb()}if(2&e){const e=t.$implicit,s=t.index,i=a.mc();a.Cb(2),a.Nc(s+1),a.Cb(2),a.Nc(e.username),a.Cb(2),a.Nc(e.role),a.Cb(2),a.Nc(a.pc(9,6,e.created_at,"medium")),a.Cb(4),a.Oc(" ",i.editButtontext," "),a.Cb(2),a.Oc(" ",i.disableUserButtonText," ")}}const M=[{path:"",component:(()=>{class e{constructor(e,t,s){this.ngbDialog=e,this.userService=t,this.toasterService=s,this.editButtontext=r.b.EDIT_BUTTON_TEXT,this.disableUserButtonText=r.b.DISABLE_BUTTON_TEXT,this.loading=!1,this.currentPage=1,this.pageSize=10}ngOnInit(){this.fetchUsers(this.currentPage)}fetchUsers(e){window.scroll(0,0),this.loading=!0,this.userService.fetchUsers(this.pageSize,e).subscribe(e=>{const{ProcessVariables:{status:t,message:s={}}}=e;if(t){const{ProcessVariables:{usersList:t,totalCount:s}}=e;this.collectionSize=s,this.usersList=t,this.loading=!1}else this.loading=!1,this.toasterService.showError(s.value)},e=>{this.loading=!1,this.toasterService.showError(e)})}editUser({userId:e}){const t=this.ngbDialog.open(p,{centered:!0});t.componentInstance.userId=e,t.result.then(e=>{e===r.g.SUCCESS&&this.fetchUsers(this.currentPage)})}disableUser({userId:e,username:t}){const s=this.ngbDialog.open(S,{centered:!0});s.componentInstance.userId=e,s.componentInstance.userName=t,s.result.then(e=>{e===r.g.SUCCESS&&this.fetchUsers(this.currentPage)})}}return e.\u0275fac=function(t){return new(t||e)(a.Qb(b.c),a.Qb(l.a),a.Qb(u.a))},e.\u0275cmp=a.Kb({type:e,selectors:[["app-manage-users"]],decls:23,vars:6,consts:[[1,"main"],[1,"p-4"],[1,"container"],[1,"row"],[1,"col","card","shadow","p-0","mt-2"],["type","dark","height","0.5rem",3,"value","striped","animated",4,"ngIf"],[1,"table","table-striped"],[1,"d-flex"],[1,"col-1"],[1,"col-3"],[1,"col-2"],["class","d-flex",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center","p-2"],[3,"boundaryLinks","collectionSize","page","pageSize","pageChange"],["type","dark","height","0.5rem",3,"value","striped","animated"],[1,"shadow",3,"click"],[1,"ml-2","shadow",3,"click"]],template:function(e,t){1&e&&(a.Wb(0,"div",0),a.Wb(1,"h2",1),a.Mc(2,"Manage Users"),a.Vb(),a.Wb(3,"div",2),a.Wb(4,"div",3),a.Wb(5,"div",4),a.Kc(6,C,1,3,"ngb-progressbar",5),a.Wb(7,"table",6),a.Wb(8,"thead"),a.Wb(9,"tr",7),a.Wb(10,"th",8),a.Mc(11,"S.NO"),a.Vb(),a.Wb(12,"th",9),a.Mc(13,"USER ID"),a.Vb(),a.Wb(14,"th",9),a.Mc(15,"ROLE"),a.Vb(),a.Wb(16,"th",9),a.Mc(17,"CREATED ON"),a.Vb(),a.Wb(18,"th",10),a.Mc(19,"ACTION"),a.Vb(),a.Vb(),a.Vb(),a.Kc(20,V,15,9,"tr",11),a.Vb(),a.Wb(21,"div",12),a.Wb(22,"ngb-pagination",13),a.ic("pageChange",(function(e){return t.currentPage=e}))("pageChange",(function(){return t.fetchUsers(t.currentPage)})),a.Vb(),a.Vb(),a.Vb(),a.Vb(),a.Vb(),a.Vb()),2&e&&(a.Cb(6),a.sc("ngIf",t.loading),a.Cb(14),a.sc("ngForOf",t.usersList),a.Cb(2),a.sc("boundaryLinks",!0)("collectionSize",t.collectionSize)("page",t.currentPage)("pageSize",t.pageSize))},directives:[i.m,i.l,b.e,b.f],pipes:[i.e],styles:["table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#fff;font-size:14px;background-color:#5b2e8f;border:1px solid #5b2e8f}"]}),e})(),pathMatch:"full"}];let W=(()=>{class e{}return e.\u0275mod=a.Ob({type:e}),e.\u0275inj=a.Nb({factory:function(t){return new(t||e)},imports:[[n.e.forChild(M)],n.e]}),e})(),I=(()=>{class e{}return e.\u0275mod=a.Ob({type:e}),e.\u0275inj=a.Nb({factory:function(t){return new(t||e)},imports:[[i.c,c.a,W]]}),e})()}}]);